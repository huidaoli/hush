tinymce.PluginManager.add('yimage', function(editor, url) {
	
	// body
	var plug_name = 'Image Manager';
	var plug_tips = '图片管理工具';
	var win_body = [
	{type:'notification', text:'系统会对图片进行适当压缩，请保证原图不要超过8M。', style:'width:458px;top:10px;'},
	{type:'spacer', style:'height:5px;'},
	{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:!0}
	];
	
	// Add a button that opens a window
	editor.addButton('yimage', {
		text : '',
		icon : 'image',
		tooltip : plug_tips,
		onclick : function() {
			// Open window
			editor.windowManager.open({
				title : plug_name,
				body : win_body,
				width : 500,
				height : 140,
				onsubmit : function(e) {
					var html = '<img src="'+e.data.src+'"/>';
					editor.insertContent(html);
				}
			});
		}
	});

	// Adds a menu item to the tools menu
	editor.addMenuItem('yimage', {
		text : plug_name,
		context : 'tools',
		tooltip : plug_tips,
		onclick : function() {
			// Open window
			editor.windowManager.open({
				title : plug_name,
				body : win_body,
				width : 500,
				height : 140,
				onsubmit : function(e) {
					
				}
			});
		}
	});

	return {
		getMetadata : function() {
			return {
				title : plug_name
			};
		}
	};
});